
 RUN  v2.1.9 /Volumes/Development/nofx-local-starter
      Coverage enabled with v8

{"level":30,"time":1757978451419,"pid":65658,"hostname":"Bens-MacBook-Pro-M4.local","topic":"step.ready","msg":"memq.subscribed"}
{"level":30,"time":1757978451449,"pid":65658,"hostname":"Bens-MacBook-Pro-M4.local","topic":"step.ready","payload":{"runId":"0784217a-ac47-49ab-81da-8d2483088943","stepId":"4d0bbe27-1e4f-47b7-bff7-f5b08a36ae7e","__attempt":1},"delay":0,"msg":"memq.enqueued"}
{"level":30,"time":1757978451449,"pid":65658,"hostname":"Bens-MacBook-Pro-M4.local","topic":"step.ready","payload":{"runId":"0784217a-ac47-49ab-81da-8d2483088943","stepId":"4d0bbe27-1e4f-47b7-bff7-f5b08a36ae7e","__attempt":1},"delay":0,"msg":"memq.enqueued"}
{"level":30,"time":1757978451452,"pid":65658,"hostname":"Bens-MacBook-Pro-M4.local","topic":"step.ready","jobId":2,"status":"completed","msg":"memq.completed"}
{"level":30,"time":1757978451467,"pid":65658,"hostname":"Bens-MacBook-Pro-M4.local","topic":"step.ready","jobId":1,"status":"completed","msg":"memq.completed"}
{"level":30,"time":1757978451662,"pid":65658,"hostname":"Bens-MacBook-Pro-M4.local","topic":"step.ready","payload":{"runId":"df9ebf71-c6f8-4a09-82c9-896b2c2bce71","stepId":"ba16c3b9-4ce8-41d5-97be-f849065d642f","__attempt":4},"delay":0,"msg":"memq.enqueued"}
{"level":50,"time":1757978451667,"pid":65658,"hostname":"Bens-MacBook-Pro-M4.local","topic":"step.ready","jobId":3,"status":"failed","err":{"type":"Error","message":"fail","stack":"Error: fail\n    at /Volumes/Development/nofx-local-starter/src/reliability.unit.test.ts:29:15\n    at /Volumes/Development/nofx-local-starter/src/lib/queue/MemoryAdapter.ts:84:11"},"msg":"memq.failed"}
{"level":40,"time":1757978451670,"pid":65658,"hostname":"Bens-MacBook-Pro-M4.local","topic":"step.ready","jobId":3,"attempts":4,"dlqTopic":"step.dlq","msg":"memq.to_dlq"}
{"level":30,"time":1757978451763,"pid":65658,"hostname":"Bens-MacBook-Pro-M4.local","topic":"step.ready","payload":{"runId":"df9ebf71-c6f8-4a09-82c9-896b2c2bce71","stepId":"ba16c3b9-4ce8-41d5-97be-f849065d642f","__attempt":1},"delay":0,"msg":"memq.enqueued"}
 âœ“ src/reliability.unit.test.ts (2 tests) 372ms

 Test Files  1 passed (1)
      Tests  2 passed (2)
   Start at  18:20:50
   Duration  1.20s (transform 75ms, setup 0ms, collect 159ms, tests 372ms, environment 0ms, prepare 87ms)

 % Coverage report from v8
-------------------|---------|----------|---------|---------|-------------------
File               | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s 
-------------------|---------|----------|---------|---------|-------------------
All files          |    11.6 |    44.51 |   23.77 |    11.6 |                   
 ...trol-plane/src |       0 |        0 |       0 |       0 |                   
  main.ts          |       0 |        0 |       0 |       0 | 1-12              
 ...ne/src/modules |       0 |        0 |       0 |       0 |                   
  app.module.ts    |       0 |        0 |       0 |       0 | 1-11              
 ...e/src/services |       0 |        0 |       0 |       0 |                   
  db.service.ts    |       0 |        0 |       0 |       0 | 1-18              
  queue.service.ts |       0 |        0 |       0 |       0 | 1-24              
 ...-plane/src/web |       0 |        0 |       0 |       0 |                   
  ...controller.ts |       0 |        0 |       0 |       0 | 1-9               
  ...controller.ts |       0 |        0 |       0 |       0 | 1-50              
 .../worker-ts/src |       0 |        0 |       0 |       0 |                   
  index.ts         |       0 |        0 |       0 |       0 | 1-48              
 ...ges/shared/src |       0 |        0 |       0 |       0 |                   
  types.ts         |       0 |        0 |       0 |       0 |                   
 scripts           |       0 |        0 |       0 |       0 |                   
  createBucket.ts  |       0 |        0 |       0 |       0 | 1-18              
  importModels.ts  |       0 |        0 |       0 |       0 | 1-50              
  runGate.js       |       0 |        0 |       0 |       0 | 1-179             
  ...WriteRules.ts |       0 |        0 |       0 |       0 | 1-29              
  ...erredOrder.ts |       0 |        0 |       0 |       0 | 1-16              
 src               |       0 |        0 |       0 |       0 |                   
  simple.ts        |       0 |        0 |       0 |       0 | 1-17              
 src/api           |       0 |        0 |       0 |       0 |                   
  loader.ts        |       0 |        0 |       0 |       0 | 1-25              
  main.ts          |       0 |        0 |       0 |       0 | 1-200             
  planBuilder.ts   |       0 |        0 |       0 |       0 | 1-60              
 src/api/routes    |       0 |        0 |       0 |       0 |                   
  auth.ts          |       0 |        0 |       0 |       0 | 1-21              
  backups.ts       |       0 |        0 |       0 |       0 | 1-23              
  dev.ts           |       0 |        0 |       0 |       0 | 1-162             
  gates.ts         |       0 |        0 |       0 |       0 | 1-71              
  metrics.ts       |       0 |        0 |       0 |       0 | 1-15              
  models.ts        |       0 |        0 |       0 |       0 | 1-123             
  queue.ts         |       0 |        0 |       0 |       0 | 1-62              
  settings.ts      |       0 |        0 |       0 |       0 | 1-43              
  ui.ts            |       0 |        0 |       0 |       0 | 1-53              
 src/lib           |    21.3 |    56.71 |   26.76 |    21.3 |                   
  artifacts.ts     |       0 |        0 |       0 |       0 | 1-24              
  auth.ts          |       0 |        0 |       0 |       0 | 1-37              
  autobackup.ts    |       0 |        0 |       0 |       0 | 1-25              
  backup.ts        |       0 |        0 |       0 |       0 | 1-196             
  cache.ts         |       0 |        0 |       0 |       0 | 1-52              
  db.ts            |      25 |      100 |       0 |      25 | 11-26             
  events.ts        |       0 |        0 |       0 |       0 | 1-5               
  logger.ts        |     100 |       50 |     100 |     100 | 11                
  metrics.ts       |   97.67 |       50 |   16.66 |   97.67 | 110-112           
  ...lImporters.ts |       0 |        0 |       0 |       0 | 1-95              
  models.ts        |       0 |        0 |       0 |       0 | 1-39              
  observability.ts |   21.42 |      100 |   16.66 |   21.42 | ...28,31-32,36-67 
  queue.ts         |     100 |      100 |     100 |     100 |                   
  secrets.ts       |       0 |        0 |       0 |       0 | 1-55              
  settings.ts      |       0 |        0 |       0 |       0 | 1-151             
  store.ts         |      42 |       70 |   35.55 |      42 | ...76-277,279-280 
  supabase.ts      |       0 |        0 |       0 |       0 | 1-19              
  tracing.ts       |       0 |        0 |       0 |       0 | 1-63              
 src/lib/queue     |   63.95 |     64.7 |      50 |   63.95 |                   
  MemoryAdapter.ts |   93.33 |     65.9 |   81.81 |   93.33 | ...16-118,121-123 
  RedisAdapter.ts  |   22.22 |      100 |       0 |   22.22 | ...03-113,117-118 
  index.ts         |     100 |    57.14 |   57.14 |     100 | 6,15-16           
 src/models        |       0 |        0 |       0 |       0 |                   
  router.ts        |       0 |        0 |       0 |       0 | 1-160             
 ...dels/providers |       0 |        0 |       0 |       0 |                   
  anthropic.ts     |       0 |        0 |       0 |       0 | 1-14              
  gemini.ts        |       0 |        0 |       0 |       0 | 1-16              
  http.ts          |       0 |        0 |       0 |       0 | 1-12              
  openai.ts        |       0 |        0 |       0 |       0 | 1-57              
 src/policy        |       0 |        0 |       0 |       0 |                   
  dbWritePolicy.ts |       0 |        0 |       0 |       0 | 1-9               
 src/shared        |       0 |        0 |       0 |       0 |                   
  types.ts         |       0 |        0 |       0 |       0 | 1-16              
 src/tools         |       0 |        0 |       0 |       0 |                   
  codegen.ts       |       0 |        0 |       0 |       0 | 1-17              
 src/worker        |       0 |        0 |       0 |       0 |                   
  main.ts          |       0 |        0 |       0 |       0 | 1-74              
  relay.ts         |       0 |        0 |       0 |       0 | 1-32              
  runner.ts        |       0 |        0 |       0 |       0 | 1-71              
 ...orker/handlers |       0 |    11.11 |   11.11 |       0 |                   
  codegen.ts       |       0 |        0 |       0 |       0 | 1-52              
  db_write.ts      |       0 |        0 |       0 |       0 | 1-129             
  gate.ts          |       0 |        0 |       0 |       0 | 1-99              
  git_pr.ts        |       0 |        0 |       0 |       0 | 1-169             
  loader.ts        |       0 |        0 |       0 |       0 | 1-20              
  manual.ts        |       0 |        0 |       0 |       0 | 1-47              
  test_echo.ts     |       0 |        0 |       0 |       0 | 1-17              
  test_fail.ts     |       0 |        0 |       0 |       0 | 1-15              
  types.ts         |       0 |        0 |       0 |       0 |                   
-------------------|---------|----------|---------|---------|-------------------

[33mThe CJS build of Vite's Node API is deprecated. See https://vite.dev/guide/troubleshooting.html#vite-cjs-node-api-deprecated for more details.[39m
