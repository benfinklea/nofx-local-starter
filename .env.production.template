# NOFX Control Plane - Production Environment Variables
# Copy this to Vercel Dashboard → Project Settings → Environment Variables

# =============================================================================
# DATABASE (CRITICAL)
# =============================================================================

# IMPORTANT: Must use Supabase TRANSACTION POOLER for serverless
# Format: postgresql://user:pass@aws-0-REGION.pooler.supabase.com:6543/postgres
#
# Key requirements:
# - Hostname: *.pooler.supabase.com (not db.supabase.co)
# - Port: 6543 (not 5432)
# - Database: postgres
#
# Get from: Supabase Dashboard → Project Settings → Database → Connection pooling
DATABASE_URL=postgresql://postgres.xxxxx:PASSWORD@aws-0-us-east-1.pooler.supabase.com:6543/postgres

# =============================================================================
# SUPABASE CLIENT
# =============================================================================

# Supabase project URL
# Get from: Supabase Dashboard → Project Settings → API → Project URL
SUPABASE_URL=https://xxxxx.supabase.co

# Supabase anonymous key (safe to expose to frontend)
# Get from: Supabase Dashboard → Project Settings → API → Project API keys → anon public
SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

# Supabase service role key (NEVER expose to frontend, server-side only)
# Get from: Supabase Dashboard → Project Settings → API → Project API keys → service_role
SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

# =============================================================================
# WORKER AUTHENTICATION
# =============================================================================

# Secret for manually triggering worker endpoint
# Generate with: openssl rand -base64 32
WORKER_SECRET=your-random-secret-here

# Admin password (fallback for worker auth)
ADMIN_PASSWORD=your-admin-password-here

# Worker batch size (optional, defaults to 10)
WORKER_BATCH_SIZE=10

# =============================================================================
# OPENAI (If using AI features)
# =============================================================================

# OpenAI API key
# Get from: https://platform.openai.com/api-keys
OPENAI_API_KEY=sk-...

# =============================================================================
# ANTHROPIC (If using Claude)
# =============================================================================

# Anthropic API key
# Get from: https://console.anthropic.com/settings/keys
ANTHROPIC_API_KEY=sk-ant-...

# =============================================================================
# GOOGLE (If using Gemini or OAuth)
# =============================================================================

# Google Gemini API key
GOOGLE_API_KEY=...

# Google OAuth (if using Google login)
GOOGLE_CLIENT_ID=...
GOOGLE_CLIENT_SECRET=...

# =============================================================================
# STRIPE (If using payments)
# =============================================================================

# Stripe secret key (server-side)
# Get from: https://dashboard.stripe.com/apikeys
STRIPE_SECRET_KEY=sk_live_...

# Stripe publishable key (client-side)
STRIPE_PUBLISHABLE_KEY=pk_live_...

# Stripe webhook secret
# Get from: https://dashboard.stripe.com/webhooks
STRIPE_WEBHOOK_SECRET=whsec_...

# =============================================================================
# OTHER OPTIONAL
# =============================================================================

# Node environment (Vercel sets this automatically)
NODE_ENV=production

# Log level (debug, info, warn, error)
LOG_LEVEL=info

# =============================================================================
# DEPLOYMENT CHECKLIST
# =============================================================================

# After adding/updating environment variables in Vercel:
#
# 1. [ ] Verify DATABASE_URL uses pooler.supabase.com:6543
# 2. [ ] Set environment scope (Production, Preview, Development)
# 3. [ ] Redeploy project (env var changes don't auto-deploy)
# 4. [ ] Check function logs to verify no env var warnings
# 5. [ ] Monitor Supabase connection count (should stay < 10)
#
# Common mistakes:
# - Using wrong DATABASE_URL (port 5432 instead of 6543)
# - Forgetting to redeploy after changing env vars
# - Setting env vars only for Production (not Preview/Development)
# - Exposing SUPABASE_SERVICE_ROLE_KEY to frontend

# =============================================================================
# MONITORING
# =============================================================================

# Check these dashboards after deployment:
# - Vercel: Functions → Logs (check for env var warnings)
# - Supabase: Database → Connection pooling (should see < 10 connections)
# - Supabase: Database → Logs (check for connection errors)
