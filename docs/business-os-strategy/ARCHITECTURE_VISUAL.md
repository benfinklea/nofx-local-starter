# Visual Architecture Diagrams

## 🏗️ The Complete System Stack

```
                    🌟 THE NARRATIVE OS ECOSYSTEM 🌟

┌─────────────────────────────────────────────────────────────────────────────┐
│                           👥 USER INTERFACES                                │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────┐ │
│  │  📖 Narrative   │  │  📊 Dashboard   │  │  📱 Mobile      │  │  🗣️ Voice │ │
│  │     Canvas      │  │     View        │  │     App         │  │  Interface│ │
│  │                 │  │                 │  │                 │  │           │ │
│  │ "Every morning, │  │  ━━━━━━━━━━━━━  │  │   Quick Actions │  │ "Run my   │ │
│  │  Sales Scout    │  │  📈 Revenue     │  │   🔔 Alerts     │  │  morning  │ │
│  │  checks for     │  │  📋 Tasks       │  │   📊 Metrics    │  │  routine" │ │
│  │  new leads..."  │  │  🎯 Goals       │  │   ⚡ Controls   │  │           │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────┘ │
└─────────────────────────────────────────────────────────────────────────────┘
                                    ⬇️
┌─────────────────────────────────────────────────────────────────────────────┐
│                      🎭 CHARACTER ABSTRACTION LAYER                         │
│                                                                             │
│  🕵️ Sales Scout      👔 Account Mgr     📅 Calendar       📧 Email         │
│  • Energetic        • Methodical       • Organized        • Professional    │
│  • Optimistic       • Thorough         • Detail-oriented  • Timely          │
│  • Fast-paced       • Conservative     • Reliable         • Clear           │
│                                                                             │
│  💰 Accountant      🚚 Fulfillment     📞 Support         🎨 Designer       │
│  • Precise          • Efficient        • Empathetic       • Creative        │
│  • Rule-following   • Reliable         • Patient          • Visual          │
│  • Careful          • Process-driven   • Helpful          • Innovative      │
└─────────────────────────────────────────────────────────────────────────────┘
                                    ⬇️
┌─────────────────────────────────────────────────────────────────────────────┐
│                    🧠 NARRATIVE PROCESSING ENGINE                           │
│                                                                             │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐             │
│  │  📝 Story       │  │  🎬 Scene       │  │  ⚙️ Workflow    │             │
│  │     Parser      │  │     Compiler    │  │     Generator   │             │
│  │                 │  │                 │  │                 │             │
│  │ • Extract chars │  │ • Map actions   │  │ • Create steps  │             │
│  │ • Find actions  │  │ • Add logic     │  │ • Set depends   │             │
│  │ • Detect flow   │  │ • Handle errors │  │ • Validate plan │             │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘             │
│                                                                             │
│  📊 Real-time Compilation → 🎯 Visual Preview → ▶️ One-click Execute        │
└─────────────────────────────────────────────────────────────────────────────┘
                                    ⬇️
┌─────────────────────────────────────────────────────────────────────────────┐
│                      🏢 BUSINESS OPERATING SYSTEM                           │
│                                                                             │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐             │
│  │  👥 Entity      │  │  📄 Document    │  │  💰 Ledger      │             │
│  │     Manager     │  │     Store       │  │     Service     │             │
│  │                 │  │                 │  │                 │             │
│  │ • Customers     │  │ • Contracts     │  │ • Transactions  │             │
│  │ • Vendors       │  │ • Invoices      │  │ • Balances      │             │
│  │ • Employees     │  │ • Receipts      │  │ • Reports       │             │
│  │ • Products      │  │ • Compliance    │  │ • Audits        │             │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘             │
│                                                                             │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐             │
│  │  🛡️ Policy      │  │  📡 Comms       │  │  🔗 External    │             │
│  │     Engine      │  │     Hub         │  │     Integrations│             │
│  │                 │  │                 │  │                 │             │
│  │ • Rules         │  │ • Email         │  │ • Stripe        │             │
│  │ • Approval      │  │ • SMS           │  │ • QuickBooks    │             │
│  │ • Compliance    │  │ • Notifications │  │ • Salesforce    │             │
│  │ • Validation    │  │ • Webhooks      │  │ • Shipping APIs │             │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘             │
└─────────────────────────────────────────────────────────────────────────────┘
                                    ⬇️
┌─────────────────────────────────────────────────────────────────────────────┐
│                         ⚙️ NOFX WORKFLOW ENGINE                             │
│                                                                             │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐             │
│  │  🔧 Handler     │  │  📋 Step        │  │  📊 Event       │             │
│  │     Registry    │  │     Executor    │  │     Tracker     │             │
│  │                 │  │                 │  │                 │             │
│  │ • Code Gen      │  │ • DAG deps      │  │ • Timeline      │             │
│  │ • DB Ops        │  │ • Retries       │  │ • Metrics       │             │
│  │ • API Calls     │  │ • Policies      │  │ • Artifacts     │             │
│  │ • File Ops      │  │ • Parallelism   │  │ • Audit Trail   │             │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘             │
│                                                                             │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐             │
│  │  🔄 Queue       │  │  💾 Storage     │  │  📈 Monitoring  │             │
│  │     System      │  │     Layer       │  │     Stack       │             │
│  │                 │  │                 │  │                 │             │
│  │ • Redis/Memory  │  │ • PostgreSQL    │  │ • Prometheus    │             │
│  │ • Backpressure  │  │ • File System   │  │ • Grafana       │             │
│  │ • Dead Letter   │  │ • S3 Compatible │  │ • OpenTelemetry │             │
│  │ • Scheduling    │  │ • Encryption    │  │ • Alerts        │             │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 🌊 The Data Flow Journey

```
    👤 Entrepreneur writes story
           ⬇️
    📝 "Every morning, Sales Scout checks CRM..."
           ⬇️
    🧠 NLP Parser extracts:
       • Characters: Sales Scout, Account Manager
       • Actions: checks, tells, schedules
       • Conditions: if promising, when available
           ⬇️
    🎭 Character Registry maps:
       • Sales Scout → CRM handler
       • Account Manager → Lead qualification
       • Calendar Assistant → Booking system
           ⬇️
    🎬 Scene Compiler creates:
       • Step 1: crm_search (Sales Scout personality)
       • Step 2: data_transfer (Scout → Manager)
       • Step 3: lead_scoring (Manager personality)
       • Step 4: conditional (if score > threshold)
       • Step 5: calendar_booking (Assistant personality)
           ⬇️
    🏢 Business OS enriches with:
       • Entity references (customer, lead objects)
       • Policy checks (approval thresholds)
       • External integrations (Salesforce, Calendly)
           ⬇️
    ⚙️ NOFX executes workflow:
       • Queues steps with dependencies
       • Applies character personalities to handlers
       • Tracks progress with business events
           ⬇️
    📊 Real-time updates flow back:
       • Timeline shows "Sales Scout found 5 leads"
       • Character interactions visualized
       • Business metrics updated automatically
```

## 🎨 Character Personality System

```
                    🎭 CHARACTER PERSONALITIES

    🕵️ SALES SCOUT                 👔 ACCOUNT MANAGER
    ┌─────────────────┐             ┌─────────────────┐
    │ Formality  ●────│ Casual      │ Formality ────●─│ Professional
    │ Speed     ────●─│ Fast        │ Speed     ●─────│ Deliberate
    │ Risk      ──●───│ Bold        │ Risk      ●─────│ Conservative
    │ Energy    ────●─│ High        │ Energy    ──●───│ Moderate
    └─────────────────┘             └─────────────────┘
         ⬇️ Affects                      ⬇️ Affects
    • Email tone: "Hey! 🎉"         • Email tone: "Good morning,"
    • Response time: Immediate      • Response time: Thoughtful
    • Error handling: Retry fast    • Error handling: Careful review
    • Data detail: Quick summary    • Data detail: Full analysis

    📅 CALENDAR ASSISTANT           💰 ACCOUNTANT
    ┌─────────────────┐             ┌─────────────────┐
    │ Formality ────●─│ Professional│ Formality ────●─│ Very Formal
    │ Speed     ────●─│ Efficient   │ Speed     ●─────│ Methodical
    │ Risk      ●─────│ Ultra Safe  │ Risk      ●─────│ Zero Risk
    │ Detail    ────●─│ Precise     │ Detail    ────●─│ Exhaustive
    └─────────────────┘             └─────────────────┘
         ⬇️ Affects                      ⬇️ Affects
    • Always confirms timezone      • Triple-checks calculations
    • Sends multiple reminders      • Requires documentation
    • Handles conflicts gracefully  • Flags any discrepancies
    • Professional communication    • Formal audit trails
```

## 🔄 Live Execution Visualization

```
                    📊 REAL-TIME TIMELINE VIEW

Time: 09:15 AM ────────────────────────────────────────► 09:45 AM

🕵️ Sales Scout
    ├── 09:15 ● "Starting my morning lead check..."
    ├── 09:16 ✅ "Found 12 new leads in Salesforce!"
    ├── 09:17 📊 "Scoring leads... top 3 look promising!"
    └── 09:18 💬 "Hey Account Manager, got some hot leads for you! 🔥"

👔 Account Manager
    ├── 09:18 ● "Reviewing leads from Sales Scout..."
    ├── 09:22 🔍 "Deep diving into Acme Corp - 850 employees, perfect fit!"
    ├── 09:28 ⭐ "Scored Acme Corp: 95/100 - definitely worth a call"
    └── 09:30 📞 "Calendar Assistant, please set up a call with Acme Corp"

📅 Calendar Assistant
    ├── 09:30 ● "Checking availability for Account Manager..."
    ├── 09:31 🌍 "Confirming timezone for Acme Corp (PST)"
    ├── 09:32 📧 "Sending meeting invite with agenda"
    └── 09:35 ✅ "Meeting scheduled for Thursday 2 PM PST"

📧 Email Specialist
    ├── 09:35 ● "Drafting follow-up email sequence..."
    ├── 09:38 📝 "Email 1: Thank you for your time (send now)"
    ├── 09:39 📝 "Email 2: Case study relevant to their industry (send +2 days)"
    └── 09:40 📊 "Follow-up sequence activated, tracking engagement"

                    ✨ WORKFLOW COMPLETED ✨
                "Lead to Meeting" process: 25 minutes
                Next trigger: Meeting reminder (24h before)
```

## 🏗️ Technical Stack Visualization

```
                    💻 TECHNOLOGY ARCHITECTURE

    ┌─────────────────── FRONTEND ───────────────────┐
    │                                                │
    │  React 18 + TypeScript + Vite                 │
    │  ├── 🎨 Tailwind CSS (Styling)                │
    │  ├── 🎭 Framer Motion (Animations)            │
    │  ├── 📊 D3.js (Timeline Visualizations)       │
    │  ├── 🗣️ Web Speech API (Voice Interface)       │
    │  ├── 📡 Socket.io (Real-time Updates)         │
    │  └── 🧪 Playwright (E2E Testing)              │
    │                                                │
    └────────────────── APIs ───────────────────────┘
    │                                                │
    │  ┌── REST APIs ──┐  ┌── GraphQL ──┐  ┌─ SSE ─┐ │
    │  │ • CRUD ops   │  │ • Complex    │  │ • Live │ │
    │  │ • File upload│  │   queries    │  │ • Real │ │
    │  │ • Auth       │  │ • Relations  │  │   time │ │
    │  └──────────────┘  └──────────────┘  └───────┘ │
    │                                                │
    └─────────────────── BACKEND ───────────────────┘
    │                                                │
    │  Node.js + Express + TypeScript                │
    │  ├── 🏢 Business OS Service                    │
    │  ├── 🧠 Narrative Processing                   │
    │  ├── ⚙️ NOFX Integration                       │
    │  ├── 🔐 JWT Authentication                     │
    │  ├── 📡 External API Adapters                  │
    │  └── 📊 Prometheus Metrics                     │
    │                                                │
    └─────────────────── DATA LAYER ────────────────┘
    │                                                │
    │  ┌── PostgreSQL ──┐  ┌── Redis ───┐  ┌─ S3 ──┐ │
    │  │ • Entities     │  │ • Cache    │  │ • Docs │ │
    │  │ • Ledger       │  │ • Sessions │  │ • Files│ │
    │  │ • Audit Trail  │  │ • Queue    │  │ • Media│ │
    │  │ • Row-level    │  │ • Real-time│  │ • Logs │ │
    │  │   Security     │  │   Data     │  │        │ │
    │  └────────────────┘  └────────────┘  └───────┘ │
    │                                                │
    └─────────────────── INFRASTRUCTURE ────────────┘
                                    │
        Docker + Kubernetes + GitHub Actions
        ├── 📊 Monitoring (Grafana + Prometheus)
        ├── 🔍 Logging (ELK Stack)
        ├── 🚨 Alerting (PagerDuty)
        ├── 🔐 Secrets (Vault)
        └── 🌍 CDN (Cloudflare)
```

## 🎯 User Journey Flow

```
                        👤 ENTREPRENEUR'S DAY

🌅 MORNING (7:00 AM)
├── 📱 Opens mobile app
├── 🗣️ "Run my morning routine"
├── 🤖 System executes: Lead check → Email review → Task prioritization
└── 📊 Dashboard shows: 5 new leads, 3 urgent emails, 2 overdue tasks

☀️ MIDDAY (12:00 PM)
├── 💻 Opens narrative canvas
├── 📝 "When payment comes in, automatically send thank you and start fulfillment"
├── 🎭 System suggests: Payment Processor, Email Specialist, Fulfillment Manager
├── ▶️ Tests workflow with sample payment
└── ✅ Activates new automation

🌆 EVENING (6:00 PM)
├── 📊 Reviews dashboard metrics
├── 👀 Sees: 85% automation success rate, $2,400 processed today
├── 📖 Reads timeline: "Email Specialist sent 12 follow-ups, 3 responses"
├── 🎨 Adjusts Sales Scout personality: More formal for enterprise leads
└── 💾 System learns preferences for tomorrow

🌙 NIGHT (10:00 PM)
├── 📱 Gets notification: "Tomorrow's calendar optimized"
├── 👀 Reviews: 3 sales calls scheduled, 1 vendor meeting, 2 hours for strategy
├── 🤖 System prepared: Meeting briefs, agenda templates, follow-up sequences
└── 😴 Sleeps peacefully knowing business runs itself
```

## 🚀 Deployment Flow

```
                    🔄 CI/CD PIPELINE VISUALIZATION

┌─── DEVELOPMENT ──────────────────────────────────────────────────────────┐
│                                                                          │
│  👨‍💻 Developer pushes code                                               │
│       ⬇️                                                                │
│  🧪 Automated Testing                                                    │
│  ├── Unit tests (Jest)                ✅ 95% coverage                   │
│  ├── Integration tests (Supertest)    ✅ All APIs working               │
│  ├── E2E tests (Playwright)          ✅ User journeys pass              │
│  └── Security scan (Snyk)            ✅ No vulnerabilities              │
│       ⬇️                                                                │
│  🏗️ Build Process                                                       │
│  ├── TypeScript compilation          ✅ No type errors                  │
│  ├── Bundle optimization (Vite)      ✅ < 500KB gzipped                │
│  ├── Asset optimization              ✅ Images compressed               │
│  └── Docker image creation           ✅ Multi-stage build               │
│       ⬇️                                                                │
└──────────────────────────────────────────────────────────────────────────┘

┌─── STAGING ──────────────────────────────────────────────────────────────┐
│                                                                          │
│  🚀 Deploy to Staging                                                    │
│  ├── Database migrations             ✅ Schema updated                   │
│  ├── Feature flag validation         ✅ New features enabled             │
│  ├── Performance testing             ✅ < 200ms response time            │
│  └── User acceptance testing         ✅ Product team approval            │
│       ⬇️                                                                │
└──────────────────────────────────────────────────────────────────────────┘

┌─── PRODUCTION ───────────────────────────────────────────────────────────┐
│                                                                          │
│  🌍 Blue-Green Deployment                                                │
│  ├── Deploy to green environment     ✅ Health checks pass              │
│  ├── Smoke tests                     ✅ Critical paths working           │
│  ├── Traffic gradual switch (10%)    ✅ No error rate increase          │
│  ├── Monitor metrics (30 min)        ✅ All systems green               │
│  └── Complete traffic switch         ✅ Deployment successful            │
│       ⬇️                                                                │
│  📊 Post-Deployment Monitoring                                           │
│  ├── Application metrics             📈 Response time, throughput        │
│  ├── Business metrics                💰 Stories executed, success rate   │
│  ├── Error tracking                  🚨 Alerts if issues detected        │
│  └── User feedback                   📝 In-app feedback collection       │
│                                                                          │
└──────────────────────────────────────────────────────────────────────────┘
```

---

## 💭 Mental Model Summary

Think of this system like a **theater production**:

🎭 **The Stage** = Your business
📖 **The Script** = Your narrative description
🎬 **The Director** = NOFX workflow engine
🎨 **The Characters** = Business function personalities
🎪 **The Theater** = Business OS infrastructure
👥 **The Audience** = You (watching it all work perfectly)

When you write a story, you're essentially **directing a play** where each character has their own personality and skills, but they all work together to make your business run smoothly. The magic is that you don't need to understand the technical complexity underneath - you just describe what you want to happen, and the system figures out how to make it work!

Pretty, right? ✨
